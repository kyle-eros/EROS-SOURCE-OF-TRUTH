{
  "creationTime": "1757043548912",
  "etag": "gLB+FJzm7dtO9P6NYiErww==",
  "id": "of-scheduler-proj:mart.v_mm_base_180d",
  "kind": "bigquery#table",
  "lastModifiedTime": "1757043548912",
  "location": "US",
  "numActiveLogicalBytes": "0",
  "numBytes": "0",
  "numLongTermBytes": "0",
  "numLongTermLogicalBytes": "0",
  "numRows": "0",
  "numTotalLogicalBytes": "0",
  "schema": {
    "fields": [
      {
        "name": "username_std",
        "type": "STRING"
      },
      {
        "name": "sending_ts",
        "type": "TIMESTAMP"
      },
      {
        "name": "sending_dt_local",
        "type": "DATETIME"
      },
      {
        "name": "date_local",
        "type": "DATE"
      },
      {
        "name": "hod_local",
        "type": "INTEGER"
      },
      {
        "name": "dow_local",
        "type": "INTEGER"
      },
      {
        "name": "price_usd",
        "type": "FLOAT"
      },
      {
        "name": "earnings_usd",
        "type": "FLOAT"
      },
      {
        "name": "sent",
        "type": "INTEGER"
      },
      {
        "name": "viewed",
        "type": "INTEGER"
      },
      {
        "name": "purchased",
        "type": "INTEGER"
      },
      {
        "name": "is_ppv",
        "type": "INTEGER"
      }
    ]
  },
  "selfLink": "https://bigquery.googleapis.com/bigquery/v2/projects/of-scheduler-proj/datasets/mart/tables/v_mm_base_180d",
  "tableReference": {
    "datasetId": "mart",
    "projectId": "of-scheduler-proj",
    "tableId": "v_mm_base_180d"
  },
  "type": "VIEW",
  "view": {
    "query": "SELECT\n  LOWER(TRIM(m.username_std)) AS username_std,\n  m.sending_ts,\n  DATETIME(m.sending_ts, p.tz) AS sending_dt_local,\n  DATE(m.sending_ts, p.tz)     AS date_local,\n  EXTRACT(HOUR FROM DATETIME(m.sending_ts, p.tz)) AS hod_local,\n  MOD(EXTRACT(DAYOFWEEK FROM DATE(m.sending_ts, p.tz)) + 5, 7) AS dow_local,  -- Mon=0..Sun=6\n  SAFE_CAST(m.price_usd    AS FLOAT64) AS price_usd,\n  SAFE_CAST(m.earnings_usd AS FLOAT64) AS earnings_usd,\n  SAFE_CAST(m.sent         AS INT64)   AS sent,\n  SAFE_CAST(m.viewed       AS INT64)   AS viewed,\n  SAFE_CAST(m.purchased    AS INT64)   AS purchased,\n  CASE WHEN m.price_usd IS NOT NULL AND m.price_usd > 0 THEN 1 ELSE 0 END AS is_ppv\nFROM `of-scheduler-proj.core.message_facts` m\nJOIN `of-scheduler-proj.core.page_dim` p USING (username_std)\nWHERE m.sending_ts >= TIMESTAMP_SUB(CURRENT_TIMESTAMP(), INTERVAL 180 DAY)",
    "useLegacySql": false
  }
}
